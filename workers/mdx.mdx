---
$type: Worker
$id: mdx
name: mdx
main: src/index.ts
compatibility_date: "2025-01-01"
node_compat: true
account_id: b6641681fe423910342b9ffa1364c76d
workers_dev: true

routes:
  - pattern: mdx.do/*
    zone_name: do
---

# MDX Demo Worker

A Cloudflare Worker demonstrating **@hono/mdx** package functionality with streaming SSR and custom React components.

## Features

- ‚úÖ **MDX Rendering** - Render MDX content with full Markdown + JSX support
- ‚úÖ **Custom React Components** - Button, Card, Alert, CodeBlock components
- ‚úÖ **Streaming SSR** - Progressive rendering with React 19's renderToReadableStream
- ‚úÖ **Non-Streaming Mode** - Static rendering for SEO/email
- ‚úÖ **Frontmatter Parsing** - YAML frontmatter support
- ‚úÖ **Dynamic Content** - Query params and request headers
- ‚úÖ **Hono Framework** - Fast, lightweight routing

## Available Routes

### Basic Examples

- **GET /** - Home page with navigation
- **GET /hello** - Simple MDX rendering
- **GET /frontmatter** - Frontmatter parsing demo
- **GET /components** - Custom React components showcase

### Advanced Examples

- **GET /streaming** - Streaming SSR demo
- **GET /non-streaming** - Static rendering demo
- **GET /dynamic** - Dynamic content generation

### Documentation

- **GET /about** - About @hono/mdx
- **GET /api** - API documentation

## Custom Components

### Button Component

Styled button with variant support:

```jsx
<Button>Click me!</Button>
<Button variant="secondary">Secondary</Button>
```

### Card Component

Container with optional title:

```jsx
<Card title="Welcome">
  Content here
</Card>
```

### Alert Component

Colored alerts with different types:

```jsx
<Alert type="info">Info message</Alert>
<Alert type="warning">Warning message</Alert>
<Alert type="error">Error message</Alert>
<Alert type="success">Success message</Alert>
```

### CodeBlock Component

Syntax-highlighted code blocks:

```jsx
<CodeBlock language="javascript">
  const x = 42
</CodeBlock>
```

## Streaming vs Non-Streaming

### Streaming SSR

- **Faster TTFB** - Browser receives HTML immediately
- **Progressive Rendering** - Content appears incrementally
- **Better UX** - Users see content sooner

```ts
app.get('/streaming', (c) => {
  return c.mdx(content, {
    renderOptions: { streaming: true }
  })
})
```

### Static Rendering

- **Complete HTML** - Server waits until all content rendered
- **SEO-Friendly** - Better for some crawlers
- **Email/PDF** - Required for non-streaming clients

```ts
app.get('/non-streaming', (c) => {
  return c.mdx(content, {
    renderOptions: { streaming: false }
  })
})
```

## Dynamic Content

Access query parameters and headers:

```ts
app.get('/dynamic', (c) => {
  const name = c.req.query('name') || 'World'
  const timestamp = new Date().toISOString()
  const userAgent = c.req.header('user-agent') || 'Unknown'

  return c.mdx(`# Hello, ${name}! Generated at ${timestamp}`)
})
```

## Dependencies

- `hono` - Fast, lightweight web framework
- `@hono/mdx` - MDX rendering for Hono
- `react` - React library
- `react-dom` - React DOM renderer

## Implementation

```typescript
/**
 * MDX Demo Worker
 *
 * Demonstrates @hono/mdx package functionality:
 * - Basic MDX rendering
 * - Custom React components
 * - Streaming and non-streaming modes
 * - Frontmatter parsing
 * - Dynamic content generation
 */

import { Hono } from 'hono'
import { mdx } from '@hono/mdx'
import { createElement as h } from 'react'

// Define custom React components using createElement
const Button = ({ children, variant = 'primary' }: { children: React.ReactNode; variant?: string }) =>
  h(
    'button',
    {
      style: {
        padding: '0.75rem 1.5rem',
        borderRadius: '0.5rem',
        border: 'none',
        backgroundColor: variant === 'primary' ? '#3b82f6' : '#6b7280',
        color: 'white',
        fontSize: '1rem',
        fontWeight: '600',
        cursor: 'pointer',
        transition: 'all 0.2s',
      },
    },
    children
  )

const Card = ({ title, children }: { title?: string; children: React.ReactNode }) =>
  h(
    'div',
    {
      style: {
        border: '1px solid #e5e7eb',
        borderRadius: '0.75rem',
        padding: '1.5rem',
        marginBottom: '1rem',
        backgroundColor: '#ffffff',
        boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)',
      },
    },
    title &&
      h(
        'h3',
        {
          style: {
            marginTop: 0,
            marginBottom: '1rem',
            fontSize: '1.25rem',
            fontWeight: '600',
          },
        },
        title
      ),
    h('div', null, children)
  )

const Alert = ({ type = 'info', children }: { type?: 'info' | 'warning' | 'error' | 'success'; children: React.ReactNode }) => {
  const colors = {
    info: { bg: '#dbeafe', border: '#3b82f6', text: '#1e40af' },
    warning: { bg: '#fef3c7', border: '#f59e0b', text: '#92400e' },
    error: { bg: '#fee2e2', border: '#ef4444', text: '#991b1b' },
    success: { bg: '#d1fae5', border: '#10b981', text: '#065f46' },
  }
  const style = colors[type]

  return h(
    'div',
    {
      style: {
        padding: '1rem',
        borderRadius: '0.5rem',
        border: `2px solid ${style.border}`,
        backgroundColor: style.bg,
        color: style.text,
        marginBottom: '1rem',
      },
    },
    children
  )
}

const CodeBlock = ({ children, language = 'typescript' }: { children: React.ReactNode; language?: string }) =>
  h(
    'div',
    {
      style: {
        marginBottom: '1rem',
      },
    },
    h(
      'div',
      {
        style: {
          backgroundColor: '#1f2937',
          color: '#9ca3af',
          padding: '0.5rem 1rem',
          borderTopLeftRadius: '0.5rem',
          borderTopRightRadius: '0.5rem',
          fontSize: '0.875rem',
          fontWeight: '600',
        },
      },
      language
    ),
    h(
      'pre',
      {
        style: {
          backgroundColor: '#111827',
          color: '#e5e7eb',
          padding: '1rem',
          borderBottomLeftRadius: '0.5rem',
          borderBottomRightRadius: '0.5rem',
          overflow: 'auto',
          margin: 0,
        },
      },
      h('code', null, children)
    )
  )

// Create Hono app with MDX middleware
const app = new Hono()

// Apply MDX middleware with custom components
app.use(
  '*',
  mdx({
    components: {
      Button,
      Card,
      Alert,
      CodeBlock,
    },
    compileOptions: {
      development: true, // Enable better error messages in development
    },
  })
)

// Home page - Navigation and feature overview
app.get('/', (c) => {
  return c.mdx(`
# @hono/mdx Demo

Welcome to the **@hono/mdx** demo worker! This demonstrates rendering MDX content in Cloudflare Workers using Hono.

## Available Examples

<Card title="üìù Basic Examples">

- [/hello](/hello) - Simple MDX rendering
- [/frontmatter](/frontmatter) - Frontmatter parsing
- [/components](/components) - Custom React components

</Card>

<Card title="‚ö° Advanced Examples">

- [/streaming](/streaming) - Streaming SSR demo
- [/non-streaming](/non-streaming) - Static rendering
- [/dynamic](/dynamic) - Dynamic content generation

</Card>

<Card title="üìñ Documentation">

- [/about](/about) - About this demo
- [/api](/api) - API documentation

</Card>

## Quick Example

Here's what you can do with @hono/mdx:

<Alert type="info">
This entire page is rendered from MDX with custom React components!
</Alert>

<CodeBlock>
import { Hono } from 'hono'
import { renderMDX } from '@hono/mdx'

const app = new Hono()

app.get('/', (c) => {
  return renderMDX(c, '# Hello World!')
})

export default app
</CodeBlock>

<Button>Get Started ‚Üí</Button>
`)
})

// Simple hello world example
app.get('/hello', (c) => {
  return c.mdx(`
# Hello from MDX! üëã

This is a simple example of rendering MDX content in a Cloudflare Worker.

## Features

- **Markdown syntax** - Write content naturally
- **React components** - Use JSX components inline
- **Full streaming** - Progressive rendering with React 19
- **Edge runtime** - Fast, global deployment

## Try it yourself

\`\`\`typescript
import { renderMDX } from '@hono/mdx'

app.get('/hello', (c) => {
  return c.mdx('# Hello World!')
})
\`\`\`

[‚Üê Back to home](/)
`)
})

// Frontmatter example
app.get('/frontmatter', (c) => {
  const content = `---
title: Frontmatter Demo
author: Claude
date: 2025-01-04
tags: [mdx, hono, cloudflare]
---

# {title}

Written by **{author}** on {date}

<Alert type="success">
This page uses YAML frontmatter to define metadata!
</Alert>

## Tags

{tags.map(tag => \`- \${tag}\`).join('\\n')}

## How it Works

The frontmatter is parsed and available as props in your MDX:

<CodeBlock>
---
title: My Post
author: John Doe
---

# {title}

By {author}
</CodeBlock>

[‚Üê Back to home](/)
`

  return c.mdx(content)
})

// Custom components example
app.get('/components', (c) => {
  return c.mdx(`
# Custom React Components üé®

@hono/mdx lets you use custom React components directly in your MDX.

## Button Component

<Button>Click me!</Button>

<Button variant="secondary">Secondary Button</Button>

## Card Component

<Card title="Welcome">
This is a card component with a title and content.
</Card>

<Card>
This is a card without a title.
</Card>

## Alert Component

<Alert type="info">
‚ÑπÔ∏è This is an info alert
</Alert>

<Alert type="warning">
‚ö†Ô∏è This is a warning alert
</Alert>

<Alert type="error">
‚ùå This is an error alert
</Alert>

<Alert type="success">
‚úÖ This is a success alert
</Alert>

## Code Block Component

<CodeBlock language="javascript">
function hello() {
  console.log('Hello from MDX!')
}
</CodeBlock>

<CodeBlock language="python">
def hello():
    print("Hello from MDX!")
</CodeBlock>

[‚Üê Back to home](/)
`)
})

// Streaming example
app.get('/streaming', (c) => {
  return c.mdx(
    `
# Streaming SSR Example üåä

This page uses **streaming server-side rendering** with React 19's \`renderToReadableStream\`.

<Alert type="info">
Content is progressively sent to the browser as it's rendered, resulting in faster time-to-first-byte and better perceived performance.
</Alert>

## Benefits

<Card title="‚ö° Faster TTFB">
The browser receives HTML immediately, before the entire page is rendered.
</Card>

<Card title="üì¶ Progressive Rendering">
Content appears incrementally, improving perceived performance.
</Card>

<Card title="üéØ Better UX">
Users see content sooner, even for large pages.
</Card>

## Implementation

<CodeBlock>
app.get('/streaming', (c) => {
  return c.mdx(content, {
    renderOptions: { streaming: true }
  })
})
</CodeBlock>

[‚Üê Back to home](/)
`,
    {
      renderOptions: { streaming: true },
    }
  )
})

// Non-streaming example
app.get('/non-streaming', (c) => {
  return c.mdx(
    `
# Non-Streaming (Static) Example üìÑ

This page uses **static rendering** - the entire HTML is generated before sending.

<Alert type="info">
With streaming disabled, the server waits until all content is rendered before sending the response.
</Alert>

## When to Use

<Card title="üîç SEO-Critical Pages">
Some search engine crawlers work better with complete HTML.
</Card>

<Card title="üìß Email Templates">
Email clients don't support streaming.
</Card>

<Card title="üñºÔ∏è PDF Generation">
PDF generators need complete HTML.
</Card>

## Implementation

<CodeBlock>
app.get('/non-streaming', (c) => {
  return c.mdx(content, {
    renderOptions: { streaming: false }
  })
})
</CodeBlock>

[‚Üê Back to home](/)
`,
    {
      renderOptions: { streaming: false },
    }
  )
})

// Dynamic content example
app.get('/dynamic', (c) => {
  const name = c.req.query('name') || 'World'
  const timestamp = new Date().toISOString()
  const userAgent = c.req.header('user-agent') || 'Unknown'

  return c.mdx(`
# Dynamic Content Example üé≤

This page is generated dynamically based on the request.

<Alert type="success">
Generated at: **${timestamp}**
</Alert>

## Query Parameters

Hello, **${name}**! üëã

Try: [/dynamic?name=Alice](/dynamic?name=Alice)

## Request Headers

<Card title="User Agent">
\`${userAgent}\`
</Card>

## How it Works

<CodeBlock>
app.get('/dynamic', (c) => {
  const name = c.req.query('name') || 'World'
  const timestamp = new Date().toISOString()

  return c.mdx(\\\`
# Hello, \\\${name}!

Generated at: \\\${timestamp}
  \\\`)
})
</CodeBlock>

[‚Üê Back to home](/)
`)
})

// About page
app.get('/about', (c) => {
  return c.mdx(`
# About @hono/mdx üìñ

**@hono/mdx** is a package that brings MDX rendering to Hono with full streaming support.

## Features

<Card title="‚úÖ Full Streaming Support">
Progressive rendering with React 19's \`renderToReadableStream\`
</Card>

<Card title="‚úÖ Custom Components">
Use your own React components in MDX
</Card>

<Card title="‚úÖ File-based or String-based">
Render from files or strings
</Card>

<Card title="‚úÖ Plugin System">
Support for remark/rehype plugins
</Card>

<Card title="‚úÖ TypeScript First">
Full type safety
</Card>

<Card title="‚úÖ Cloudflare Workers Optimized">
Uses Web Streams API for edge compatibility
</Card>

## Installation

<CodeBlock language="bash">
npm install @hono/mdx hono react react-dom
</CodeBlock>

## Quick Start

<CodeBlock>
import { Hono } from 'hono'
import { mdx } from '@hono/mdx'

const app = new Hono()

app.use('*', mdx())

app.get('/', (c) => c.mdx('# Hello World!'))

export default app
</CodeBlock>

[‚Üê Back to home](/)
`)
})

// API documentation
app.get('/api', (c) => {
  return c.mdx(`
# API Documentation üìö

## Core Functions

### \`renderMDX(context, content, options?)\`

Render MDX content to a Hono response.

<CodeBlock>
import { renderMDX } from '@hono/mdx'

app.get('/doc', (c) => {
  return renderMDX(c, '# Hello World')
})
</CodeBlock>

### \`mdx(options?)\`

Hono middleware that extends context with MDX helpers.

<CodeBlock>
app.use('*', mdx({
  components: { Button, Card },
  compileOptions: {
    development: true
  }
}))

app.get('/', (c) => c.mdx('# Hello'))
</CodeBlock>

### \`mdxHandler(content, options?)\`

Create a route handler from MDX content.

<CodeBlock>
import { mdxHandler } from '@hono/mdx'

app.get('/about', mdxHandler(\\\`
# About Us

We build awesome MDX tools!
\\\`))
</CodeBlock>

## Options

<Card title="MDXRenderOptions">

- **components** - Custom React components
- **props** - Props to pass to MDX
- **compileOptions** - MDX compilation options
- **renderOptions** - React rendering options
- **template** - Custom HTML template
- **css** - Custom CSS
- **scripts** - JavaScript files to include

</Card>

[‚Üê Back to home](/)
`)
})

// 404 handler
app.notFound((c) => {
  return c.mdx(`
# 404 - Page Not Found üò¢

The page you're looking for doesn't exist.

<Alert type="error">
**Error 404**: The requested URL was not found on this server.
</Alert>

## Available Pages

- [Home](/)
- [Hello](/hello)
- [Frontmatter](/frontmatter)
- [Components](/components)
- [Streaming](/streaming)
- [Non-Streaming](/non-streaming)
- [Dynamic](/dynamic)
- [About](/about)
- [API](/api)

[‚Üê Back to home](/)
`)
})

// Error handler
app.onError((err, c) => {
  console.error('Error:', err)

  return c.mdx(`
# Error 500 - Internal Server Error üî•

<Alert type="error">
**${err.name}**: ${err.message}
</Alert>

## Stack Trace

\`\`\`
${err.stack || 'No stack trace available'}
\`\`\`

[‚Üê Back to home](/)
`)
})

export default app
```

## Use Cases

1. **Documentation Sites** - Render docs with custom components
2. **Landing Pages** - Create marketing pages with MDX
3. **Blog Posts** - Write content in Markdown with JSX
4. **Interactive Demos** - Combine content and components
5. **API Documentation** - Generate API docs from MDX

## Benefits

- **Developer Experience** - Write content in familiar Markdown syntax
- **Flexibility** - Mix content and interactive components
- **Performance** - Streaming SSR for fast page loads
- **Edge Deployment** - Run at the edge for global performance
- **Type Safety** - Full TypeScript support
